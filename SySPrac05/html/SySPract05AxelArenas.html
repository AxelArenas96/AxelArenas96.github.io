
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Practica 5 Series de Fourier en tiempo continuo</title><meta name="generator" content="MATLAB 9.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-15"><meta name="DC.source" content="SySPract05AxelArenas.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Practica 5 Series de Fourier en tiempo continuo</h1><!--introduction--><p>Materia: <i>Se&ntilde;ales y Sistemas</i></p><p>Profesor: <i>Dr. Rafael Mart&iacute;nez Mart&iacute;nez</i></p><p>Grupo: <i>2TV1</i></p><p>Alumnos:</p><p><i>1.- Arenas Caldera Axel Jacobo</i></p><p><i>2.- Cornejo Martinez Mar&iacute;a de los Angeles</i></p><p><i>3.- Islas Martinez Porfirio Ezequiel</i></p><p><i>4.- Moreno Pilar Yael Maximiliano</i></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Introducci&oacute;n</a></li><li><a href="#2">Ejemplo 6.1</a></li><li><a href="#3">Ejemplo 6.2</a></li><li><a href="#4">Ejemplo 6.4</a></li><li><a href="#5">Ejemplo 6.5</a></li><li><a href="#6">Ejemplo 6.7</a></li><li><a href="#12">C6.2</a></li><li><a href="#13">Ap&eacute;ndice A</a></li><li><a href="#14">Referencias</a></li></ul></div><h2 id="1">Introducci&oacute;n</h2><p>Cuando se quiere obtener la serie de Fourier de una funci&oacute;n se necesitan ciertos coeficientes, dos en el caso de la serie de Fourier trigonom&eacute;trica y uno en el caso de la serie de Fourier trigonom&eacute;trica compacta y de la serie de Fourier exponencial compleja. En el caso particular de la serie de Fourier trigonom&eacute;trica y la serie de Fourier exponencial compleja debemos de aplicar una integral para obtener dichos coeficientes, esta integral puede realizarse de manera anal&iacute;tica o num&eacute;rica.</p><p>Los m&eacute;todos de integraci&oacute;n num&eacute;ricos permiten obtener una aproximaci&oacute;n al resultado real a trav&eacute;s de calcular &aacute;reas con evaluaciones de la funci&oacute;n y otras caracter&iacute;sticas que var&iacute;an seg&uacute;n el m&eacute;todo que se utilice.</p><p>De manera que al aplicar un m&eacute;todo de integraci&oacute;n num&eacute;rico a los c&aacute;lculos de los coeficientes para las series de Fourier se obtiene una aproximaci&oacute;n a los coeficientes reales de la serie de Fourier. Exploraremos dos casos para ello.</p><div><ul><li>Coeficientes de Fourier a trav&eacute;s de la regla del trapecio compuesta</li></ul></div><p>La regla del trapecio calcula el &aacute;rea de un trapecio definido por la funci&oacute;n en un intervalo. En la regla del trapecio compuesta se extiende esta idea al subdividir el intervalo de integraci&oacute;n en varios subintervalos y aplicar en cada uno de ellos la regla del trapecio.</p><p>De manera que la f&oacute;rmula es la siguiente:</p><p><img src="SySPract05AxelArenas_eq08431210943222162965.png" alt="$$ D_n = \frac{1}{T_0}\int_{<T_0&gt;}f(t)e^{-jnw_0t}dt = \frac{h}{2T_0}[f(a)e^{-jnw_0(a)}+2\sum_{i=1}^{k-1}f(x_i)e^{-jnw_0(x_i)}+f(b)e^{-jnw_0(b)}]$$" style="width:542px;height:43px;"></p><p>Donde :</p><p><img src="SySPract05AxelArenas_eq10504220877453604019.png" alt="$$ T_0 = b - a = $$" style="width:81px;height:13px;"> un periodo de la funci&oacute;n</p><p><img src="SySPract05AxelArenas_eq06282252685087855265.png" alt="$$ w_0 = \frac{2\pi}{T_0} $$" style="width:54px;height:33px;"></p><p><img src="SySPract05AxelArenas_eq04977081058668590031.png" alt="$$ k = $$" style="width:22px;height:11px;"> n&uacute;mero de subintervalos</p><p><img src="SySPract05AxelArenas_eq14863172941955844420.png" alt="$$ h = \frac{T_0}{k} $$" style="width:44px;height:30px;"></p><p><img src="SySPract05AxelArenas_eq06627272425783372210.png" alt="$$ x_i = a + ih, i = 1,2,...,k-1 $$" style="width:182px;height:14px;"></p><div><ul><li>Coeficientes de Fourier a trav&eacute;s de la transformada de Fourier discreta</li></ul></div><p>En este caso, se sustituye la integral por la expresi&oacute;n de la transformada de Fourier discreta, la cual utiliza muestras de una funci&oacute;n en un periodo.</p><p><img src="SySPract05AxelArenas_eq01597902974432609018.png" alt="$$ D_n = \frac{1}{T_0}\int_{<T_0&gt;}f(t)e^{-jnw_0t}dt = \lim_{T \to \infty}\frac{1}{N_0T}\sum_{k=0}^{N_0-1}f(kT)e^{-jnw_0kT}T $$" style="width:390px;height:44px;"></p><p>Donde :</p><p><img src="SySPract05AxelArenas_eq00672937272721419574.png" alt="$$ T_0 = $$" style="width:30px;height:13px;"> un periodo de la funci&oacute;n</p><p><img src="SySPract05AxelArenas_eq06282252685087855265.png" alt="$$ w_0 = \frac{2\pi}{T_0} $$" style="width:54px;height:33px;"></p><p><img src="SySPract05AxelArenas_eq03691215884921771863.png" alt="$$ T =  $$" style="width:26px;height:10px;"> el tiempo entre cada muestra</p><p><img src="SySPract05AxelArenas_eq00393898158540568512.png" alt="$$ N_0 = \frac{T_0}{T}$$" style="width:54px;height:30px;"></p><p>Reduciendo la ecuaci&oacute;n y tomando el valor de T muy peque&ntilde;o, obtenemos el siguiente resultado:</p><p><img src="SySPract05AxelArenas_eq07985723446936673561.png" alt="$$ D_n = \frac{1}{N_0}\sum_{k=0}^{N_0-1}f(kT)e^{-jn \Omega_0} $$" style="width:166px;height:44px;"></p><p>Donde:</p><p><img src="SySPract05AxelArenas_eq15745950497452336326.png" alt="$$ \Omega_0 = w_0T = \frac{2\pi}{N_o} $$" style="width:102px;height:33px;"></p><p>El obtener los coeficientes de Fourier de esta manera tiene la ventaja que cada <img src="SySPract05AxelArenas_eq12780569016122823364.png" alt="$n+N_0$" style="width:43px;height:13px;"> coeficientes, los coeficientes se repiten.</p><p>Por &uacute;ltimo, se sugiere que los valores de <img src="SySPract05AxelArenas_eq14438439004078460794.png" alt="$N_0$" style="width:16px;height:13px;"> sean una potencia de 2</p><h2 id="2">Ejemplo 6.1</h2><p>Funci&oacute;n:</p><p><img src="SySPract05AxelArenas_eq06101002436395843338.png" alt="$x(t)=e^{-\frac{t}{2}}$" style="width:65px;height:18px;"></p><p>con:  <img src="SySPract05AxelArenas_eq09604619485993121195.png" alt="$T_0=\pi \qquad \omega_0=\frac{2\pi}{T_0}=2\frac{rad}{s}$" style="width:166px;height:20px;"></p><p>Coeficientes:</p><p><img src="SySPract05AxelArenas_eq07195647503888473123.png" alt="$a_0=\frac{1}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}\;dt=0.504$" style="width:157px;height:20px;"></p><p><img src="SySPract05AxelArenas_eq13145744956295871591.png" alt="$a_n=\frac{2}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}cos(2nt)\;dt=0.504\frac{2}{1+16n^{2}}$" style="width:247px;height:20px;"></p><p><img src="SySPract05AxelArenas_eq16551966659271499038.png" alt="$b_n=\frac{2}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}sen(2nt)\;dt=0.504\frac{8n}{1+16n^{2}}$" style="width:248px;height:20px;"></p><p>Serie de Fourier Trigonom&eacute;trica</p><p><img src="SySPract05AxelArenas_eq10436690197199664204.png" alt="$x(t)=0.504[1+\sum_{n=1}^{\infty}\frac{2}{1+16n^{2}}(cos(2nt)+4nsen(2nt))]$" style="width:339px;height:19px;"></p><p>Para el espectro trigonom&eacute;trico necesitamos obtener los coeficientes de la serie de Fourier Trigonom&eacute;trica Compacta como sigue:</p><p>Coeficientes y &aacute;ngulos</p><p><img src="SySPract05AxelArenas_eq06195826154917497647.png" alt="$C_0=a_0=0.504$" style="width:102px;height:14px;"></p><p><img src="SySPract05AxelArenas_eq14397954184291596972.png" alt="$C_n=\sqrt{a_n^2+b_n^2}=\sqrt{(0.504\frac{2}{1+16n^{2}})^2+(0.504\frac{8n}{1+16n^{2}})^2}=0.504(\frac{2}{\sqrt{1+16n^2}})$" style="width:434px;height:27px;"></p><p><img src="SySPract05AxelArenas_eq00903561336215319935.png" alt="$\theta_n=tan^{-1}(\frac{-b_n}{a_n})=tan^{-1}(-4n)=-tan^{-1}(4n)$" style="width:288px;height:20px;"></p><p>Serie de Fourier Trigonom&eacute;trica Compacta</p><p><img src="SySPract05AxelArenas_eq10901924468710009434.png" alt="$x(t)=0.504+0.504\sum_{n=1}^{\infty}\frac{2}{\sqrt{1+16n^{2}}}cos(2nt-tan^{-1}(4n))]$" style="width:353px;height:22px;"></p><p>Espectro trigonom&eacute;trico de Fourier con 4 arm&oacute;nicos</p><p><img vspace="5" hspace="5" src="Ejemplo_61_4a.jpg" alt=""> </p><p>Espectro trigonom&eacute;trico de Fourier con 15 arm&oacute;nicos</p><p><img vspace="5" hspace="5" src="Ejemplo_61_15a.jpg" alt=""> </p><p>Luego obtenemos <img src="SySPract05AxelArenas_eq10145827984828201794.png" alt="$D_0$" style="width:17px;height:13px;"> y <img src="SySPract05AxelArenas_eq10922897471658752443.png" alt="$D_n$" style="width:18px;height:13px;"> como sigue:</p><p><img src="SySPract05AxelArenas_eq16864225916871900812.png" alt="$D_0=a_0=0.504$" style="width:104px;height:13px;"></p><p><img src="SySPract05AxelArenas_eq04424599307635906588.png" alt="$D_n=\frac{1}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}e^{-2njt}\;dt=-\frac{2}{\pi}(e^{-\frac{\pi}{2}}-1)\frac{1}{1+4nj}=0.5042\frac{1}{1+4nj}$" style="width:370px;height:22px;"></p><p>Con estos datos procedemos a utilizar la funci&oacute;n del Ap&eacute;ndice A con 4 arm&oacute;nicos y el resultado es el siguiente:</p><p><img vspace="5" hspace="5" src="Ej_61_4a.jpg" alt=""> </p><p>y ahora con 15 arm&oacute;nicos:</p><p><img vspace="5" hspace="5" src="Ej_61_15a.jpg" alt=""> </p><h2 id="3">Ejemplo 6.2</h2><p>Funci&oacute;n:</p><p><img src="SySPract05AxelArenas_eq02738866139020038417.png" alt="$x(t)=\{\begin{array}{c}6t\qquad-\frac{1}{2}<t<\frac{1}{2}\\-6t+6\qquad\frac{1}{2}<t<\frac{3}{2}\end{array}$" style="width:198px;height:36px;"></p><p>con:  <img src="SySPract05AxelArenas_eq17999488192625243713.png" alt="$T_0=2 \qquad \omega_0=\frac{2\pi}{T_0}=\pi$" style="width:148px;height:20px;"></p><p>Coeficientes:</p><p><img src="SySPract05AxelArenas_eq12305237217198406678.png" alt="$a_0=\frac{1}{2}\int_{-\frac{1}{2}}^{\frac{3}{2}}x(t)\;dt=0$" style="width:138px;height:27px;"></p><p><img src="SySPract05AxelArenas_eq17047741865211954861.png" alt="$a_n=\frac{2}{2}\int_{-\frac{1}{2}}^{\frac{3}{2}}x(t)cos(n\pi t)\;dt=0$" style="width:194px;height:27px;"></p><p>Debido a la simetr&iacute;a de la se&ntilde;al <img src="SySPract05AxelArenas_eq14833433867325483769.png" alt="$x(t)$" style="width:23px;height:15px;"> los coeficientes <img src="SySPract05AxelArenas_eq13844031523365800707.png" alt="$a_0=a_n=0$" style="width:74px;height:13px;"></p><p>Luego obtenemos <img src="SySPract05AxelArenas_eq10145827984828201794.png" alt="$D_0$" style="width:17px;height:13px;"> y <img src="SySPract05AxelArenas_eq10922897471658752443.png" alt="$D_n$" style="width:18px;height:13px;"> como sigue:</p><p><img src="SySPract05AxelArenas_eq12336761580951831697.png" alt="$D_0=a_0=0$" style="width:78px;height:13px;"></p><p><img src="SySPract05AxelArenas_eq00275619288744791553.png" alt="$D_n=\frac{1}{2}\int_{-\frac{1}{2}}^{\frac{3}{2}}x(t)e^{-n\pi tj}\;dt=3sen(\frac{n\pi}{2})[\frac{n\pi -2j}{n^2\pi^2}]+[-e^{-1.5n\pi j}+e^{-0.5n\pi j}][\frac{3}{2n\pi j}+\frac{3}{n^2\pi^2}]$" style="width:494px;height:27px;"></p><p>As&iacute; la serie de Fourier exponencial compleja queda:</p><p><img src="SySPract05AxelArenas_eq08829980066059196316.png" alt="$x(t)=\sum_{-\infty}^{\infty}[3sen(\frac{n\pi}{2})[\frac{n\pi -2j}{n^2\pi^2}]+[-e^{-1.5n\pi j}+e^{-0.5n\pi j}][\frac{3}{2n\pi j}+\frac{3}{n^2\pi^2}]]e^{n\pi jt}$" style="width:438px;height:22px;"></p><p>Con estos datos procedemos a utilizar la funci&oacute;n del Ap&eacute;ndice A con 4 arm&oacute;nicos y el resultado es el siguiente:</p><p><img vspace="5" hspace="5" src="Ej_62_4a.jpg" alt=""> </p><p>y ahora con 15 arm&oacute;nicos:</p><p><img vspace="5" hspace="5" src="Ej_62_15a.jpg" alt=""> </p><h2 id="4">Ejemplo 6.4</h2><p>Funcion:</p><p><img src="SySPract05AxelArenas_eq13966795063753228476.png" alt="$x(t)=\{\begin{array}{c}0\qquad-\pi<t<-\frac{\pi}{2}\\1\qquad-\frac{\pi}{2}<t<\frac{\pi}{2}\\0\qquad\frac{\pi}{2}<t<\pi\end{array}$" style="width:186px;height:51px;"></p><p>con:  <img src="SySPract05AxelArenas_eq11947739367053143804.png" alt="$T_0=2\pi \qquad \omega_0=\frac{2\pi}{T_0}=1$" style="width:155px;height:20px;"></p><p>Coeficientes exponenciales</p><p><img src="SySPract05AxelArenas_eq03343156458115250703.png" alt="$D_0=\frac{1}{2}$" style="width:45px;height:18px;"></p><p><img src="SySPract05AxelArenas_eq03406278263652763021.png" alt="$D_n=\frac{1}{n\pi}sen(\frac{n\pi}{2})$" style="width:102px;height:19px;"></p><p>Serie de Fourier exponencial compleja</p><p><img src="SySPract05AxelArenas_eq07583363974518046828.png" alt="$x(t)=\frac{1}{2}+\sum_{-\infty}^{\infty}\frac{1}{n\pi}sen(\frac{n\pi}{2})e^{njt}$" style="width:195px;height:19px;"></p><p>Luego con estos datos procedemos a utilizar la funci&oacute;n del Ap&eacute;ndice A con 4 arm&oacute;nicos y el resultado es el siguiente:</p><p><img vspace="5" hspace="5" src="Ej_64_4a.jpg" alt=""> </p><p>y ahora con 15 arm&oacute;nicos:</p><p><img vspace="5" hspace="5" src="Ej_64_15a.jpg" alt=""> </p><h2 id="5">Ejemplo 6.5</h2><p>Funci&oacute;n:</p><p><img src="SySPract05AxelArenas_eq06101002436395843338.png" alt="$x(t)=e^{-\frac{t}{2}}$" style="width:65px;height:18px;"></p><p>con:  <img src="SySPract05AxelArenas_eq09604619485993121195.png" alt="$T_0=\pi \qquad \omega_0=\frac{2\pi}{T_0}=2\frac{rad}{s}$" style="width:166px;height:20px;"></p><p>Coeficientes exponenciales</p><p><img src="SySPract05AxelArenas_eq16864225916871900812.png" alt="$D_0=a_0=0.504$" style="width:104px;height:13px;"></p><p><img src="SySPract05AxelArenas_eq04424599307635906588.png" alt="$D_n=\frac{1}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}e^{-2njt}\;dt=-\frac{2}{\pi}(e^{-\frac{\pi}{2}}-1)\frac{1}{1+4nj}=0.5042\frac{1}{1+4nj}$" style="width:370px;height:22px;"></p><p>Serie de fourier exponencial compleja</p><p><img src="SySPract05AxelArenas_eq07380539059753261198.png" alt="$x(t)=0.504\sum_{-\infty}^{\infty}\frac{0.504}{1+4nj}e^{2njt}$" style="width:177px;height:21px;"></p><p>Luego con estos datos procedemos a utilizar la funci&oacute;n del Ap&eacute;ndice A con 4 arm&oacute;nicos y el resultado es el siguiente:</p><p><img vspace="5" hspace="5" src="Ej_61_4a.jpg" alt=""> </p><p>y ahora con 15 arm&oacute;nicos:</p><p><img vspace="5" hspace="5" src="Ej_61_15a.jpg" alt=""> </p><h2 id="6">Ejemplo 6.7</h2><pre class="codeinput">T_0 = pi; N_0 = 256; T = T_0/N_0; t = (0:T:T*(N_0-1))'; M = 10;
x = exp(-t/2); x(1) = (exp(-pi/2) + 1)/2;
<span class="comment">%--------</span>

figure(1)
D_n = fft (x)/N_0; n = [-N_0/2:N_0/2-1]';

<span class="keyword">for</span> a = 1:1:5
mag_dft(a)=abs(fftshift(D_n(a)));
<span class="keyword">end</span>
<span class="keyword">for</span> a = 1:1:5
ang_dft(a)=angle(fftshift(D_n(a)));
<span class="keyword">end</span>
mag_dft
ang_dft
clf; subplot (2, 2, 1); stem(n, abs(fftshift (D_n)),<span class="string">'k'</span>);
axis ([-M M -.1 .6]); xlabel(<span class="string">'n'</span>); ylabel(<span class="string">'|D_n|'</span>);
subplot (2, 2, 2); stem(n, angle(fftshift(D_n)),<span class="string">'k'</span>);
axis([-M M -pi pi]); xlabel (<span class="string">'n'</span>); ylabel(<span class="string">'\angle D n [rad]'</span>);
<span class="comment">%------</span>

T_0 = pi; N_0 = 256; T = T_0/N_0; W_0=2*pi/T_0; t = (0:T:T*(N_0-1))'; M = 10;

x_0 =@(t) exp(-t/2);
x_1 =@(t) exp(-t/2)*exp(-1j*W_0*t);
x_2 =@(t) exp(-t/2)*exp(-2j*W_0*t);
x_3 =@(t) exp(-t/2)*exp(-3j*W_0*t);
x_4 =@(t) exp(-t/2)*exp(-4j*W_0*t);
</pre><pre class="codeoutput">
mag_dft =

    0.5043    0.1223    0.0625    0.0419    0.0314


ang_dft =

         0   -1.3258   -1.4464   -1.4876   -1.5083

</pre><img vspace="5" hspace="5" src="SySPract05AxelArenas_01.png" alt=""> <p>Hallando los D0,...D4 (n positiva) por trapecio compuesto</p><pre class="codeinput">figure(2)
n=[0:1:4];
D_n=[trap_com(x_0,0,pi,pi/2)/T_0,trap_com(x_1,0,pi,pi/2)/T_0,trap_com(x_2,0,pi,pi/2)/T_0,trap_com(x_3,0,pi,pi/2)/T_0,trap_com(x_4,0,pi,pi/2)/T_0];
mag_trap=abs(D_n)
ang_trap=angle(D_n)

clf; subplot (2, 2, 1); stem(n, abs( (D_n)),<span class="string">'k'</span>);
axis ([-M M -.1 .6]); xlabel(<span class="string">'n'</span>); ylabel(<span class="string">'|D_n|'</span>);
subplot (2, 2, 2); stem(n, angle((D_n)),<span class="string">'k'</span>);
axis([-M M -pi pi]); xlabel (<span class="string">'n'</span>); ylabel(<span class="string">'\angle D n [rad]'</span>);
hold <span class="string">on</span>
</pre><pre class="codeoutput">
mag_trap =

    0.5047    0.1206    0.0589    0.0363    0.0238


ang_trap =

         0   -1.3184   -1.4306   -1.4609   -1.4657

</pre><img vspace="5" hspace="5" src="SySPract05AxelArenas_02.png" alt=""> <p>De acuerdo a Lathi, en el ejemplo 6.5, que se desarroll&oacute; en el R10, la serie de Fourier exponencial compleja tiene Dn: <img src="SySPract05AxelArenas_eq11462128157880710935.png" alt="$\left.\frac{-1}{\pi (1/2+j2n)}e^{-(1/2+j2n)t}\right |_{t=0}^{\pi}$" style="width:144px;height:28px;"> Para llegar al resultado m&aacute;s preciso, no se utiliz&oacute; el resultado final de Lathi que indica <img src="SySPract05AxelArenas_eq11815252062284937394.png" alt="$\frac{0.504}{1+j4n}$" style="width:30px;height:21px;">. Sino que desarrollando, se encontr&oacute;: <img src="SySPract05AxelArenas_eq08029797175683308747.png" alt="$\frac{-1}{\pi (1/2+j2n)}(e^{-\frac{\pi}{2}}-1)$" style="width:114px;height:21px;"></p><pre class="codeinput"><span class="keyword">for</span> n=2:1:5
   mag_ex(n)=abs((-exp(-pi/2)+1)/(pi*(0.5+2j*(n-1))));
<span class="keyword">end</span>
mag_ex(1)=abs((-exp(-pi/2)+1)/(pi*(0.5)));

<span class="keyword">for</span> n=2:1:5
   ang_ex(n)=angle((-exp(-pi/2)+1)/(pi*(0.5+2j*(n-1))));
<span class="keyword">end</span>
ang_ex(1)=angle((-exp(-pi/2)+1)/(pi*(0.5)));

T = table(mag_dft',ang_dft',mag_trap',ang_trap',mag_ex',ang_ex'); T(1:5,:);
T.Properties.RowNames = {<span class="string">'D0'</span>,<span class="string">'D1'</span>,<span class="string">'D2'</span>,<span class="string">'D3'</span>,<span class="string">'D4'</span>};
T.Properties.VariableNames{<span class="string">'Var1'</span>} = <span class="string">'Abs_DFT'</span>;
T.Properties.VariableNames{<span class="string">'Var2'</span>} = <span class="string">'Ang_DFT'</span>;
T.Properties.VariableNames{<span class="string">'Var3'</span>} = <span class="string">'Abs_Trap_Com'</span>;
T.Properties.VariableNames{<span class="string">'Var4'</span>} = <span class="string">'Ang_Trap_Com'</span>;
T.Properties.VariableNames{<span class="string">'Var5'</span>} = <span class="string">'Abs_Exacto'</span>;
T.Properties.VariableNames{<span class="string">'Var6'</span>} = <span class="string">'Ang_Exacto'</span>

<span class="comment">% En su forma rectangular</span>

DFT=mag_dft.*exp(1j.*ang_dft);
TRAP=mag_trap.*exp(1j*ang_trap);
EXAC=mag_ex.*exp(1j*ang_ex);

D= table(DFT',TRAP',EXAC');
D.Properties.RowNames = {<span class="string">'D0'</span>,<span class="string">'D1'</span>,<span class="string">'D2'</span>,<span class="string">'D3'</span>,<span class="string">'D4'</span>};
D.Properties.VariableNames{<span class="string">'Var1'</span>} = <span class="string">'Dn_por_DFT'</span>;
D.Properties.VariableNames{<span class="string">'Var2'</span>} = <span class="string">'Dn_por_Trap_comp'</span>;
D.Properties.VariableNames{<span class="string">'Var3'</span>} = <span class="string">'Dn_exacto'</span>

<span class="comment">% Comparaci&oacute;n</span>
DFT_EXAC=abs(EXAC-DFT);
TRAP_EXAC=abs(EXAC-TRAP);

CMP= table(DFT_EXAC',TRAP_EXAC');
CMP.Properties.RowNames = {<span class="string">'D0'</span>,<span class="string">'D1'</span>,<span class="string">'D2'</span>,<span class="string">'D3'</span>,<span class="string">'D4'</span>};
CMP.Properties.VariableNames{<span class="string">'Var1'</span>} = <span class="string">'ERROR_DFT'</span>;
CMP.Properties.VariableNames{<span class="string">'Var2'</span>} = <span class="string">'ERROR_TRAP'</span>

<span class="comment">%Por lo tanto se puede ver que el algoritmo DFT es m&aacute;s preciso que el del</span>
<span class="comment">%trapecio compuesto, puesto que hubo menor error que el valor exacto.</span>
</pre><pre class="codeoutput">
T =

  5&times;6 table

          Abs_DFT     Ang_DFT    Abs_Trap_Com    Ang_Trap_Com    Abs_Exacto    Ang_Exacto
          ________    _______    ____________    ____________    __________    __________

    D0     0.50428          0     0.50474              0          0.50428            0   
    D1      0.1223    -1.3258     0.12063        -1.3184          0.12231      -1.3258   
    D2    0.062536    -1.4464    0.058915        -1.4306         0.062548      -1.4464   
    D3    0.041859    -1.4876    0.036274        -1.4609         0.041878      -1.4877   
    D4    0.031431    -1.5083    0.023788        -1.4657         0.031456      -1.5084   


D =

  5&times;3 table

              Dn_por_DFT          Dn_por_Trap_comp           Dn_exacto     
          ___________________    ___________________    ___________________

    D0      0.50428+0i             0.50474+0i             0.50428+0i       
    D1     0.029665+0.11865i      0.030128+0.11681i      0.029664+0.11865i 
    D2    0.0077597+0.062053i    0.0082355+0.058337i    0.0077581+0.062065i
    D3    0.0034794+0.041714i    0.0039773+0.036056i    0.0034778+0.041733i
    D4    0.0019638+0.03137i     0.0024955+0.023657i    0.0019622+0.031395i


CMP =

  5&times;2 table

          ERROR_DFT     ERROR_TRAP
          __________    __________

    D0    1.5822e-06    0.00046075
    D1    6.5235e-06     0.0019053
    D2    1.2756e-05     0.0037589
    D3    1.9053e-05     0.0056998
    D4    2.5368e-05     0.0077565

</pre><p>Serie para 4 arm&oacute;nicos</p><p><img vspace="5" hspace="5" src="Ej_67_4a.jpg" alt=""> </p><p>Serie para 15 arm&oacute;nicos</p><p><img vspace="5" hspace="5" src="Ej_67_15a.jpg" alt=""> </p><h2 id="12">C6.2</h2><pre class="language-matlab">x = @(t) mod(t+pi/2,2*pi) &lt;= pi;
t = linspace (-2*pi, 2*pi,1000);
x = @(t) mod(t+pi/2,2*pi) &lt;= pi;
sumterms = zeros(16, length(t)); sumterms(1,:) = 1/2;
<span class="keyword">for</span> n = 1:size(sumterms,1)-1;
sumterms(n+1,:) = (2/(pi*n)*sin(pi*n/2))*cos(n*t);
<span class="keyword">end</span>
x_N = cumsum (sumterms); figure(1); clf; ind = 0;
<span class="keyword">for</span> N = [0,1:2:size(sumterms, 1)-1]
ind = ind+1; subplot (3,3,ind);
plot (t,x_N(N+1))
plot (t,x(t), <span class="string">'k--'</span>); axis ([-2*pi 2*pi -0.2 1.2]);
xlabel (<span class="string">'t'</span>);
ylabel ([<span class="string">'x_{'</span>,num2str(N),<span class="string">'} (t)'</span>]);
<span class="keyword">end</span>
</pre><p><img vspace="5" hspace="5" src="Ej_C6.2.jpg" alt=""> </p><h2 id="13">Ap&eacute;ndice A</h2><p><b>C&oacute;digo Serie de Fourier Exponencial Compleja</b></p><pre class="language-matlab">
<span class="keyword">function</span> sfc(t0,tf,dn,d0,f,armo,a,b)
<span class="comment">% t0 el valor inicial para calcular la serie</span>
<span class="comment">% tf el valor final donde calcular la serie</span>
<span class="comment">% dn funci&oacute;n de la f&oacute;rmula de los dn</span>
<span class="comment">% f funci&oacute;n original</span>
<span class="comment">% armo n&uacute;mero de armonicos a utilizar en la gr&aacute;fica</span>
<span class="comment">% a, b intevalo para realizar la grafica de la serie</span>
w0=2*pi/(tf-t0);

sf=d0;
t=a:0.0001:b;

<span class="keyword">for</span> n=1:armo
    sf=sf+dn(-n)*exp(w0*-n*t*j)+dn(n)*exp(w0*n*t*j);
<span class="keyword">end</span>
figure (1)
hFig = figure(1);
set(hFig, <span class="string">'Position'</span>, [0 0 900 900])
subplot(3,2,1)
fplot(t,sf,<span class="string">'LineWidth'</span>,2)
grid <span class="string">on</span>
legend(<span class="string">'Serie de Fourier'</span>,<span class="string">'Location'</span>,<span class="string">'Best'</span>)
xlabel(<span class="string">'t'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16)

sf=d0;
t1=t0:0.0001:tf;

<span class="keyword">for</span> n=1:armo
    sf=sf+dn(-n)*exp(w0*-n*t1*j)+dn(n)*exp(w0*n*t1*j);
<span class="keyword">end</span>

subplot(3,2,2)
fplot(t1,f(t1),<span class="string">'r'</span>,<span class="string">'LineWidth'</span>,2)
grid <span class="string">on</span>
hold <span class="string">on</span>
plot(t1,sf,<span class="string">'LineWidth'</span>,2)
legend(<span class="string">'Funci&oacute;n original'</span>,<span class="string">'Serie de Fourier '</span>,<span class="string">'Location'</span>,<span class="string">'Best'</span>)
xlabel(<span class="string">'t'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16)
nn=-armo:armo;
axis <span class="string">auto</span>

subplot(3,2,4)
e=f(t1)-sf;
plot(t1,e,<span class="string">'LineWidth'</span>,2)
title(<span class="string">'Error'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16)
xlabel(<span class="string">'t'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16)
axis <span class="string">auto</span>
grid <span class="string">on</span>

subplot(3,2,6)
e=f(t1)-sf;
area(t1,e.^2)
legend(<span class="string">'Energia del error'</span>,<span class="string">'Location'</span>,<span class="string">'Best'</span>)
xlabel(<span class="string">'t'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16)
axis <span class="string">auto</span>
grid <span class="string">on</span>

absdn=zeros(1,length(nn));
cont=1;
<span class="keyword">for</span> i =-armo:armo
    <span class="keyword">if</span> i==0
        absdn(cont)=d0;
    <span class="keyword">end</span>
    
    absdn(cont)=dn(i);
    cont=cont+1;
<span class="keyword">end</span>

subplot(3,2,3)
stem(w0*nn,abs(absdn),<span class="string">'LineWidth'</span>,2)
title(<span class="string">'Espectro de magnitud D_n '</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16)
xlabel(<span class="string">'\omega'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16)
grid <span class="string">on</span>

subplot(3,2,5) <span class="comment">% % </span>
stem(w0*nn,angle(absdn),<span class="string">'LineWidth'</span>,2) <span class="comment">% % </span>
title(<span class="string">'Espectro de fase, \angle de D_n '</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16) <span class="comment">% % </span>
xlabel(<span class="string">'\omega'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16)
grid <span class="string">on</span>

<span class="keyword">end</span>

</pre><h2 id="14">Referencias</h2><p>https://grupocarman.com/blog/efecto-aliasing/</p><p>Lathi, B. P. (Bhagwandas Pannalal) Linear systems and signals/B. P. Lathi.&#8212;2nd</p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Practica 5 Series de Fourier en tiempo continuo
%
% Materia: _Señales y Sistemas_
%
% Profesor: _Dr. Rafael Martínez Martínez_
%
% Grupo: _2TV1_
% 
% Alumnos:
%
% _1.- Arenas Caldera Axel Jacobo_
%
% _2.- Cornejo Martinez María de los Angeles_
%
% _3.- Islas Martinez Porfirio Ezequiel_
%
% _4.- Moreno Pilar Yael Maximiliano_
%
%% Introducción
% Cuando se quiere obtener la serie de Fourier de una función se necesitan ciertos coeficientes, dos en el caso de la serie de Fourier trigonométrica y uno en el caso de la serie de Fourier trigonométrica compacta y de la serie de Fourier exponencial compleja. En el caso particular de la serie de Fourier trigonométrica y la serie de Fourier exponencial compleja debemos de aplicar una integral para obtener dichos coeficientes, esta integral puede realizarse de manera analítica o numérica.
%
% Los métodos de integración numéricos permiten obtener una aproximación al resultado real a través de calcular áreas con evaluaciones de la función y otras características que varían según el método que se utilice. 
%
% De manera que al aplicar un método de integración numérico a los cálculos de los coeficientes para las series de Fourier se obtiene una aproximación a los coeficientes reales de la serie de Fourier. Exploraremos dos casos para ello. 
%
% * Coeficientes de Fourier a través de la regla del trapecio compuesta
%
% La regla del trapecio calcula el área de un trapecio definido por la función en un intervalo. En la regla del trapecio compuesta se extiende esta idea al subdividir el intervalo de integración en varios subintervalos y aplicar en cada uno de ellos la regla del trapecio. 
%
% De manera que la fórmula es la siguiente:
%
% $$ D_n = \frac{1}{T_0}\int_{<T_0>}f(t)e^{-jnw_0t}dt = \frac{h}{2T_0}[f(a)e^{-jnw_0(a)}+2\sum_{i=1}^{k-1}f(x_i)e^{-jnw_0(x_i)}+f(b)e^{-jnw_0(b)}]$$
%
% Donde : 
%
% $$ T_0 = b - a = $$ un periodo de la función
%
% $$ w_0 = \frac{2\pi}{T_0} $$
%
% $$ k = $$ número de subintervalos
%
% $$ h = \frac{T_0}{k} $$
%
% $$ x_i = a + ih, i = 1,2,...,k-1 $$
%
% * Coeficientes de Fourier a través de la transformada de Fourier discreta
%
% En este caso, se sustituye la integral por la expresión de la transformada de Fourier discreta, la cual utiliza muestras de una función en un periodo.
%
% $$ D_n = \frac{1}{T_0}\int_{<T_0>}f(t)e^{-jnw_0t}dt = \lim_{T \to \infty}\frac{1}{N_0T}\sum_{k=0}^{N_0-1}f(kT)e^{-jnw_0kT}T $$
%
% Donde : 
%
% $$ T_0 = $$ un periodo de la función
%
% $$ w_0 = \frac{2\pi}{T_0} $$
%
% $$ T =  $$ el tiempo entre cada muestra
%
% $$ N_0 = \frac{T_0}{T}$$
%
% Reduciendo la ecuación y tomando el valor de T muy pequeño, obtenemos el siguiente resultado:
%
% $$ D_n = \frac{1}{N_0}\sum_{k=0}^{N_0-1}f(kT)e^{-jn \Omega_0} $$
%
% Donde:  
%
% $$ \Omega_0 = w_0T = \frac{2\pi}{N_o} $$
% 
% El obtener los coeficientes de Fourier de esta manera tiene la ventaja que cada $n+N_0$ coeficientes, los coeficientes se repiten. 
% 
% Por último, se sugiere que los valores de $N_0$ sean una potencia de 2
%% Ejemplo 6.1
%
% Función:
%
% $x(t)=e^{-\frac{t}{2}}$
%
% con:  $T_0=\pi \qquad \omega_0=\frac{2\pi}{T_0}=2\frac{rad}{s}$
%
% Coeficientes:
%
% $a_0=\frac{1}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}\;dt=0.504$
%
% $a_n=\frac{2}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}cos(2nt)\;dt=0.504\frac{2}{1+16n^{2}}$
%
% $b_n=\frac{2}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}sen(2nt)\;dt=0.504\frac{8n}{1+16n^{2}}$
%
% Serie de Fourier Trigonométrica
%
% $x(t)=0.504[1+\sum_{n=1}^{\infty}\frac{2}{1+16n^{2}}(cos(2nt)+4nsen(2nt))]$
%
% Para el espectro trigonométrico necesitamos obtener los coeficientes de
% la serie de Fourier Trigonométrica Compacta como sigue:
% 
% Coeficientes y ángulos
% 
% $C_0=a_0=0.504$
%
% $C_n=\sqrt{a_n^2+b_n^2}=\sqrt{(0.504\frac{2}{1+16n^{2}})^2+(0.504\frac{8n}{1+16n^{2}})^2}=0.504(\frac{2}{\sqrt{1+16n^2}})$
%
% $\theta_n=tan^{-1}(\frac{-b_n}{a_n})=tan^{-1}(-4n)=-tan^{-1}(4n)$
%
% Serie de Fourier Trigonométrica Compacta
%
% $x(t)=0.504+0.504\sum_{n=1}^{\infty}\frac{2}{\sqrt{1+16n^{2}}}cos(2nt-tan^{-1}(4n))]$
%
% Espectro trigonométrico de Fourier con 4 armónicos
%
% <<Ejemplo_61_4a.jpg>>
%
% Espectro trigonométrico de Fourier con 15 armónicos
%
% <<Ejemplo_61_15a.jpg>>
% 
% Luego obtenemos $D_0$ y $D_n$ como sigue:
% 
% $D_0=a_0=0.504$
%
% $D_n=\frac{1}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}e^{-2njt}\;dt=-\frac{2}{\pi}(e^{-\frac{\pi}{2}}-1)\frac{1}{1+4nj}=0.5042\frac{1}{1+4nj}$
% 
% Con estos datos procedemos a utilizar la función del Apéndice A con 4 armónicos y el resultado es el siguiente:
%
% <<Ej_61_4a.jpg>>
%
% y ahora con 15 armónicos:
% 
% <<Ej_61_15a.jpg>>
%
%% Ejemplo 6.2
%
% Función:
%
% $x(t)=\{\begin{array}{c}6t\qquad-\frac{1}{2}<t<\frac{1}{2}\\-6t+6\qquad\frac{1}{2}<t<\frac{3}{2}\end{array}$
%
% con:  $T_0=2 \qquad \omega_0=\frac{2\pi}{T_0}=\pi$
%
% Coeficientes:
%
% $a_0=\frac{1}{2}\int_{-\frac{1}{2}}^{\frac{3}{2}}x(t)\;dt=0$
%
% $a_n=\frac{2}{2}\int_{-\frac{1}{2}}^{\frac{3}{2}}x(t)cos(n\pi t)\;dt=0$
%
% Debido a la simetría de la señal $x(t)$ los coeficientes $a_0=a_n=0$
%
% Luego obtenemos $D_0$ y $D_n$ como sigue:
%
% $D_0=a_0=0$
%
% $D_n=\frac{1}{2}\int_{-\frac{1}{2}}^{\frac{3}{2}}x(t)e^{-n\pi
% tj}\;dt=3sen(\frac{n\pi}{2})[\frac{n\pi -2j}{n^2\pi^2}]+[-e^{-1.5n\pi
% j}+e^{-0.5n\pi j}][\frac{3}{2n\pi j}+\frac{3}{n^2\pi^2}]$
%
% Así la serie de Fourier exponencial compleja queda:
%
% $x(t)=\sum_{-\infty}^{\infty}[3sen(\frac{n\pi}{2})[\frac{n\pi
% -2j}{n^2\pi^2}]+[-e^{-1.5n\pi j}+e^{-0.5n\pi j}][\frac{3}{2n\pi
% j}+\frac{3}{n^2\pi^2}]]e^{n\pi jt}$
% 
% Con estos datos procedemos a utilizar la función del Apéndice A con 4
% armónicos y el resultado es el siguiente: 
%
% <<Ej_62_4a.jpg>>
%
% y ahora con 15 armónicos:
% 
% <<Ej_62_15a.jpg>>
%
%% Ejemplo 6.4
%
% Funcion:
%
% $x(t)=\{\begin{array}{c}0\qquad-\pi<t<-\frac{\pi}{2}\\1\qquad-\frac{\pi}{2}<t<\frac{\pi}{2}\\0\qquad\frac{\pi}{2}<t<\pi\end{array}$
%
% con:  $T_0=2\pi \qquad \omega_0=\frac{2\pi}{T_0}=1$
%
% Coeficientes exponenciales
%
% $D_0=\frac{1}{2}$
%
% $D_n=\frac{1}{n\pi}sen(\frac{n\pi}{2})$
%
% Serie de Fourier exponencial compleja
%
% $x(t)=\frac{1}{2}+\sum_{-\infty}^{\infty}\frac{1}{n\pi}sen(\frac{n\pi}{2})e^{njt}$
%
% Luego con estos datos procedemos a utilizar la función del Apéndice A con 4
% armónicos y el resultado es el siguiente: 
%
% <<Ej_64_4a.jpg>>
%
% y ahora con 15 armónicos:
% 
% <<Ej_64_15a.jpg>>
%
%% Ejemplo 6.5
%
% Función:
%
% $x(t)=e^{-\frac{t}{2}}$
%
% con:  $T_0=\pi \qquad \omega_0=\frac{2\pi}{T_0}=2\frac{rad}{s}$
%
% Coeficientes exponenciales
%
% $D_0=a_0=0.504$
%
% $D_n=\frac{1}{\pi}\int_{0}^{\pi}e^{-\frac{t}{2}}e^{-2njt}\;dt=-\frac{2}{\pi}(e^{-\frac{\pi}{2}}-1)\frac{1}{1+4nj}=0.5042\frac{1}{1+4nj}$
%
% Serie de fourier exponencial compleja
%
% $x(t)=0.504\sum_{-\infty}^{\infty}\frac{0.504}{1+4nj}e^{2njt}$
%
% Luego con estos datos procedemos a utilizar la función del Apéndice A con 4
% armónicos y el resultado es el siguiente: 
%
% <<Ej_61_4a.jpg>>
%
% y ahora con 15 armónicos:
% 
% <<Ej_61_15a.jpg>>
%
%% Ejemplo 6.7
T_0 = pi; N_0 = 256; T = T_0/N_0; t = (0:T:T*(N_0-1))'; M = 10;
x = exp(-t/2); x(1) = (exp(-pi/2) + 1)/2;
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

figure(1)
D_n = fft (x)/N_0; n = [-N_0/2:N_0/2-1]';

for a = 1:1:5
mag_dft(a)=abs(fftshift(D_n(a)));
end
for a = 1:1:5
ang_dft(a)=angle(fftshift(D_n(a)));
end
mag_dft
ang_dft
clf; subplot (2, 2, 1); stem(n, abs(fftshift (D_n)),'k');
axis ([-M M -.1 .6]); xlabel('n'); ylabel('|D_n|');
subplot (2, 2, 2); stem(n, angle(fftshift(D_n)),'k');
axis([-M M -pi pi]); xlabel ('n'); ylabel('\angle D n [rad]');
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

T_0 = pi; N_0 = 256; T = T_0/N_0; W_0=2*pi/T_0; t = (0:T:T*(N_0-1))'; M = 10;

x_0 =@(t) exp(-t/2);
x_1 =@(t) exp(-t/2)*exp(-1j*W_0*t);
x_2 =@(t) exp(-t/2)*exp(-2j*W_0*t);
x_3 =@(t) exp(-t/2)*exp(-3j*W_0*t);
x_4 =@(t) exp(-t/2)*exp(-4j*W_0*t);

%%
% Hallando los D0,...D4 (n positiva) por trapecio compuesto
%%
figure(2)
n=[0:1:4];
D_n=[trap_com(x_0,0,pi,pi/2)/T_0,trap_com(x_1,0,pi,pi/2)/T_0,trap_com(x_2,0,pi,pi/2)/T_0,trap_com(x_3,0,pi,pi/2)/T_0,trap_com(x_4,0,pi,pi/2)/T_0];
mag_trap=abs(D_n)
ang_trap=angle(D_n)

clf; subplot (2, 2, 1); stem(n, abs( (D_n)),'k');
axis ([-M M -.1 .6]); xlabel('n'); ylabel('|D_n|');
subplot (2, 2, 2); stem(n, angle((D_n)),'k');
axis([-M M -pi pi]); xlabel ('n'); ylabel('\angle D n [rad]');
hold on
%%
% De acuerdo a Lathi, en el ejemplo 6.5, que se desarrolló en el R10, la
% serie de Fourier exponencial compleja tiene Dn:
% $\left.\frac{-1}{\pi (1/2+j2n)}e^{-(1/2+j2n)t}\right |_{t=0}^{\pi}$
% Para llegar al resultado más preciso, no se utilizó el resultado final de
% Lathi que indica $\frac{0.504}{1+j4n}$. Sino que desarrollando, se
% encontró: $\frac{-1}{\pi (1/2+j2n)}(e^{-\frac{\pi}{2}}-1)$
%%
for n=2:1:5
   mag_ex(n)=abs((-exp(-pi/2)+1)/(pi*(0.5+2j*(n-1)))); 
end
mag_ex(1)=abs((-exp(-pi/2)+1)/(pi*(0.5)));

for n=2:1:5
   ang_ex(n)=angle((-exp(-pi/2)+1)/(pi*(0.5+2j*(n-1)))); 
end
ang_ex(1)=angle((-exp(-pi/2)+1)/(pi*(0.5)));

T = table(mag_dft',ang_dft',mag_trap',ang_trap',mag_ex',ang_ex'); T(1:5,:);
T.Properties.RowNames = {'D0','D1','D2','D3','D4'};
T.Properties.VariableNames{'Var1'} = 'Abs_DFT';
T.Properties.VariableNames{'Var2'} = 'Ang_DFT';
T.Properties.VariableNames{'Var3'} = 'Abs_Trap_Com';
T.Properties.VariableNames{'Var4'} = 'Ang_Trap_Com';
T.Properties.VariableNames{'Var5'} = 'Abs_Exacto';
T.Properties.VariableNames{'Var6'} = 'Ang_Exacto'

% En su forma rectangular

DFT=mag_dft.*exp(1j.*ang_dft);
TRAP=mag_trap.*exp(1j*ang_trap);
EXAC=mag_ex.*exp(1j*ang_ex);

D= table(DFT',TRAP',EXAC');
D.Properties.RowNames = {'D0','D1','D2','D3','D4'};
D.Properties.VariableNames{'Var1'} = 'Dn_por_DFT';
D.Properties.VariableNames{'Var2'} = 'Dn_por_Trap_comp';
D.Properties.VariableNames{'Var3'} = 'Dn_exacto'

% Comparación
DFT_EXAC=abs(EXAC-DFT);
TRAP_EXAC=abs(EXAC-TRAP);

CMP= table(DFT_EXAC',TRAP_EXAC');
CMP.Properties.RowNames = {'D0','D1','D2','D3','D4'};
CMP.Properties.VariableNames{'Var1'} = 'ERROR_DFT';
CMP.Properties.VariableNames{'Var2'} = 'ERROR_TRAP'

%Por lo tanto se puede ver que el algoritmo DFT es más preciso que el del
%trapecio compuesto, puesto que hubo menor error que el valor exacto.
%%
% Serie para 4 armónicos
%
% <<Ej_67_4a.jpg>>
%
% Serie para 15 armónicos
%
% <<Ej_67_15a.jpg>>
%
%
%% C6.2
%
%   x = @(t) mod(t+pi/2,2*pi) <= pi;
%   t = linspace (-2*pi, 2*pi,1000);
%   x = @(t) mod(t+pi/2,2*pi) <= pi;
%   sumterms = zeros(16, length(t)); sumterms(1,:) = 1/2;
%   for n = 1:size(sumterms,1)-1;
%   sumterms(n+1,:) = (2/(pi*n)*sin(pi*n/2))*cos(n*t);
%   end
%   x_N = cumsum (sumterms); figure(1); clf; ind = 0;
%   for N = [0,1:2:size(sumterms, 1)-1]
%   ind = ind+1; subplot (3,3,ind);
%   plot (t,x_N(N+1)) 
%   plot (t,x(t), 'kREPLACE_WITH_DASH_DASH'); axis ([-2*pi 2*pi -0.2 1.2]);
%   xlabel ('t'); 
%   ylabel (['x_{',num2str(N),'} (t)']);
%   end
%
% <<Ej_C6.2.jpg>>
%% Apéndice A
%
% *Código Serie de Fourier Exponencial Compleja*
%
% <include>sfc.m</include>
% 
%% Referencias
%
% https://grupocarman.com/blog/efecto-aliasing/
%
% Lathi, B. P. (Bhagwandas Pannalal)
% Linear systems and signals/B. P. Lathi.—2nd 
%
%
##### SOURCE END #####
--></body></html>